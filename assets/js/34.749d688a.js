(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{232:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"url2—网络篇"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#url2—网络篇","aria-hidden":"true"}},[t._v("#")]),t._v(" URL2—网络篇")]),t._v(" "),a("h2",{attrs:{id:"一、查找强缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、查找强缓存","aria-hidden":"true"}},[t._v("#")]),t._v(" 一、查找强缓存")]),t._v(" "),a("p",[t._v("先检查强缓存，如果命中直接使用，否则进入下一步。")]),t._v(" "),a("h2",{attrs:{id:"二、dns-解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、dns-解析","aria-hidden":"true"}},[t._v("#")]),t._v(" 二、DNS 解析")]),t._v(" "),a("p",[t._v("基本步骤")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/dht2x.png-style1",alt:"image-20200321165527870"}})]),t._v(" "),a("p",[t._v("解析过程")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/jjqfs.png-style1",alt:"image-20200321153547686"}})]),t._v(" "),a("ul",[a("li",[t._v("浏览器搜索自己的 DNS 缓存。")]),t._v(" "),a("li",[t._v("在浏览器缓存中没找到，就在操作系统缓存中查找，这一步中也会查找本机的 hosts 看看有没有对应的域名映射。")]),t._v(" "),a("li",[t._v("在系统中也没有的话，就到你的路由器来查找，因为路由器一般也会有自己的 DNS 缓存。")]),t._v(" "),a("li",[t._v("若没有，则操作系统将域名发送至 本地域名服务器——"),a("strong",[t._v("递归查询方式")]),t._v("，本地域名服务器 查询自己的 DNS 缓存，查找成功则返回结果，否则，采用"),a("strong",[t._v("迭代查询方式")]),t._v("。本地域名服务器一般都是你的网络接入服务器商提供，比如中国电信，中国移动。")]),t._v(" "),a("li",[t._v("本地域名服务器 将得到的 IP 地址返回给操作系统，同时自己也将 IP 地址缓存起来。")]),t._v(" "),a("li",[t._v("操作系统将 IP 地址返回给浏览器，同时自己也将 IP 地址缓存起来，以备下次别的用户查询时，可以直接返回结果，加快网络访问。")]),t._v(" "),a("li",[t._v("至此，浏览器已经得到了域名对应的 IP 地址。")])]),t._v(" "),a("blockquote",[a("p",[t._v("关于 DNS 还有两个细节：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("DNS")]),t._v(" 解析也是需要时间的，可以通过预解析的方式来预先获得域名所对应的 "),a("code",[t._v("IP")]),t._v("。")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("dns-prefetch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("//blog.poetries.top"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("对于静态资源，DNS 还可以和 CDN 相结合，让用户访问延迟最小的节点。")])])]),t._v(" "),a("h2",{attrs:{id:"三、建立-tcp-连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、建立-tcp-连接","aria-hidden":"true"}},[t._v("#")]),t._v(" 三、建立 TCP 连接")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("TCP 是一种面向有连接的传输层协议。")]),t._v(" > "),a("strong",[t._v("它可以保证两端（发送端和接收端）通信主机之间的通信可达。")]),t._v(" > "),a("strong",[t._v("它能够处理在传输过程中丢包、传输顺序乱掉等异常情况；此外它还能有效利用宽带，缓解网络拥堵。")])])]),t._v(" "),a("p",[t._v("这里要提醒一点，Chrome 在同一个域名下要求同时最多只能有 6 个 TCP 连接，超过 6 个的话剩下的请求就得等待。")]),t._v(" "),a("p",[t._v("建立 TCP 连接经历了下面三个阶段:")]),t._v(" "),a("ol",[a("li",[t._v("通过"),a("strong",[t._v("三次握手")]),t._v("(即总共发送 3 个数据包确认已经建立连接)建立客户端和服务器之间的连接。")]),t._v(" "),a("li",[t._v("进行数据传输。这里有一个重要的机制，就是接收方接收到数据包后必须要向发送方"),a("code",[t._v("确认")]),t._v(", 如果发送方没有接到这个"),a("code",[t._v("确认")]),t._v("的消息，就判定为数据包丢失，并重新发送该数据包。当然，发送的过程中还有一个优化策略，就是把"),a("code",[t._v("大的数据包拆成一个个小包")]),t._v("，依次传输到接收方，接收方按照这个小包的顺序把它们"),a("code",[t._v("组装")]),t._v("成完整数据包。")]),t._v(" "),a("li",[t._v("断开连接的阶段。数据传输完成，现在要断开连接了，通过"),a("strong",[t._v("四次挥手")]),t._v("来断开连接。")])]),t._v(" "),a("p",[t._v("读到这里，你应该明白 TCP 连接通过什么手段来保证数据传输的可靠性，一是"),a("code",[t._v("三次握手")]),t._v("确认连接，二是"),a("code",[t._v("数据包校验")]),t._v("保证数据到达接收方，三是通过"),a("code",[t._v("四次挥手")]),t._v("断开连接。")]),t._v(" "),a("h2",{attrs:{id:"四、发送-http-请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、发送-http-请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 四、发送 HTTP 请求")]),t._v(" "),a("p",[t._v("现在"),a("code",[t._v("TCP连接")]),t._v("建立完毕，浏览器可以和服务器开始通信，即开始发送 HTTP 请求。浏览器发 HTTP 请求要携带三样东西:"),a("strong",[t._v("请求行")]),t._v("、"),a("strong",[t._v("请求头")]),t._v("和"),a("strong",[t._v("请求体")]),t._v("。")]),t._v(" "),a("p",[t._v("首先，浏览器会向服务器发送"),a("strong",[t._v("请求行")]),t._v(",关于"),a("strong",[t._v("请求行")]),t._v("， 我们在这一部分的第一步就构建完了，贴一下内容:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求方法是GET，路径为根路径，HTTP协议版本为1.1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GET")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("\n")])])]),a("p",[t._v("结构很简单，由"),a("strong",[t._v("请求方法")]),t._v("、"),a("strong",[t._v("请求 URI")]),t._v("和"),a("strong",[t._v("HTTP 版本协议")]),t._v("组成。")]),t._v(" "),a("p",[t._v("同时也要带上"),a("strong",[t._v("请求头")]),t._v("，比如我们之前说的"),a("strong",[t._v("Cache-Control")]),t._v("、"),a("strong",[t._v("If-Modified-Since")]),t._v("、"),a("strong",[t._v("If-None-Match")]),t._v("都由可能被放入请求头中作为缓存的标识信息。当然了还有一些其他的属性，列举如下:")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("58")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),t._v("\nServer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Apache\nLast"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Modified"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Tue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(" Jan "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2010")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("48")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),t._v("\nETag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"51-47cf7e6ee8400"')]),t._v("\nAccept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Ranges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bytes\nContent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81")]),t._v("\nCache"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" max"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("86400")]),t._v("\nExpires"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" Mar "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("58")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),t._v("\nConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Keep"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Alive\nContent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html\n")])])]),a("p",[t._v("最后是请求体，请求体只有在"),a("code",[t._v("POST")]),t._v("方法下存在，常见的场景是"),a("strong",[t._v("表单提交")]),t._v("。")]),t._v(" "),a("p",[a("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/8zxeh.png-style1",alt:"image-20200321171136004"}})]),t._v(" "),a("p",[t._v("HTTP 协议是基于 TCP 协议的，所以它使用面向连接的方式发送请求，通过 stream 二进制流的方式传 给对方。当然，到了 TCP 层，它会把二进制流变成一个的报文段发送给服务器。")])])},[],!1,null,null,null);s.default=e.exports}}]);