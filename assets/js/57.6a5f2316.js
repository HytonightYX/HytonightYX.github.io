(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{256:function(t,a,s){"use strict";s.r(a);var e=s(4),r=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"如何设计一个良好的-api-接口？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何设计一个良好的-api-接口？","aria-hidden":"true"}},[t._v("#")]),t._v(" 如何设计一个良好的 API 接口？")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/mrsab.png",alt:"image-20200410132349153"}})]),t._v(" "),s("h2",{attrs:{id:"标准化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#标准化","aria-hidden":"true"}},[t._v("#")]),t._v(" 标准化")]),t._v(" "),s("p",[t._v("标准化的关键在于，尽可能少地创建自定义规范和机制，而是遵守业内通用的规范和标准。")]),t._v(" "),s("p",[t._v("一个非常好的案例是 RESTful API。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/0c65h.png-style1",alt:"image-20200410125315723"}})]),t._v(" "),s("h3",{attrs:{id:"如果存在多个资源组合的情况怎么办？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如果存在多个资源组合的情况怎么办？","aria-hidden":"true"}},[t._v("#")]),t._v(" 如果存在多个资源组合的情况怎么办？")]),t._v(" "),s("p",[t._v("可以引入子资源的概念。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/su7kg.png",alt:"image-20200410125810259"}})]),t._v(" "),s("p",[t._v("例如，查看用户编码为 1001 的用户的权限信息。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[GET] /v1/users/1001/roles/101\n")])])]),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/eo7xu.png",alt:"image-20200410125923178"}})]),t._v(" "),s("h3",{attrs:{id:"资源变化情况难以用标准-restful-api-来命名怎么办？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#资源变化情况难以用标准-restful-api-来命名怎么办？","aria-hidden":"true"}},[t._v("#")]),t._v(" 资源变化情况难以用标准 RESTful API 来命名怎么办？")]),t._v(" "),s("p",[t._v("可以用一些特殊的 actions 来命名，例如密码修改接口。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[PUT] /v1/users/1001/password/actions/modify\n")])])]),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/2x8wb.png",alt:"image-20200410130145437"}})]),t._v(" "),s("h3",{attrs:{id:"异常响应格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#异常响应格式","aria-hidden":"true"}},[t._v("#")]),t._v(" 异常响应格式")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/5wxgg.png",alt:"image-20200410130352294"}})]),t._v(" "),s("h2",{attrs:{id:"兼容性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#兼容性","aria-hidden":"true"}},[t._v("#")]),t._v(" 兼容性")]),t._v(" "),s("p",[t._v("接口不能向下兼容，业务就会收到很大影响。")]),t._v(" "),s("p",[t._v("兼容性问题可能有：")]),t._v(" "),s("ul",[s("li",[t._v("多端（安卓、IOS、PC、Pad 等）之间的接口兼容性，版本兼容性")]),t._v(" "),s("li",[t._v("服务端不停机升级，由于 API 不兼容导致的服务故障")]),t._v(" "),s("li",[t._v("...")])]),t._v(" "),s("p",[t._v("引入"),s("strong",[t._v("版本")]),t._v("概念就可以解决这些问题。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/o65un.png",alt:"image-20200410130739556"}})]),t._v(" "),s("h2",{attrs:{id:"抽象性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#抽象性","aria-hidden":"true"}},[t._v("#")]),t._v(" 抽象性")]),t._v(" "),s("p",[t._v("接口抽象都基于业务需求。")]),t._v(" "),s("p",[t._v("因此，我们一方面要定义出清晰的业务问题域模型（如数据模型、领域模型等），并建立起某个问题的现实映射，这样有利于拉起不同角色对于 API 设计认知上的统一。")]),t._v(" "),s("p",[t._v("另一方面，API 的抽象性，就可以很好地屏蔽具体的业务实现细节。为我们提供更好的可拓展性。")]),t._v(" "),s("h2",{attrs:{id:"简单性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单性","aria-hidden":"true"}},[t._v("#")]),t._v(" 简单性")]),t._v(" "),s("p",[t._v("遵守“最少知识原则”。")]),t._v(" "),s("p",[t._v("即，客户端不需要知道太多服务的 API 接口和这些 API 接口的调用细节。")]),t._v(" "),s("p",[t._v("参考设计模式中的外观模式和中介者模式。")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://qn-noter.yunxi.site/imagehost/s53nt.png",alt:"image-20200410131339888"}})]),t._v(" "),s("h2",{attrs:{id:"高性能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高性能","aria-hidden":"true"}},[t._v("#")]),t._v(" 高性能")]),t._v(" "),s("p",[t._v("上面说到的外观接口虽然保证了简单性，但是也有缺陷：")]),t._v(" "),s("ol",[s("li",[t._v("增加了服务端的业务复杂度。")]),t._v(" "),s("li",[t._v("多个服务之间的聚合，导致接口性能比较差。")]),t._v(" "),s("li",[t._v("入参字端的各种组合，可能会导致数据库的性能问题。")])]),t._v(" "),s("p",[t._v("针对上面的第 3 点，举个例子，查询场景下，暴露了过多的字段给外部组合使用，但是数据库没有相应的缩印，就会发生全表扫描。")]),t._v(" "),s("p",[t._v("所以，我们可以只提供存在索引的字段组合，给外部调用。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Result<Void> agree(Long taskId, Long caseId, Configger configger)\n")])])]),s("p",[t._v("上面要求用户必填"),s("code",[t._v("taskId")]),t._v("和"),s("code",[t._v("caseId")]),t._v("来保证数据库合理使用索引。")])])},[],!1,null,null,null);a.default=r.exports}}]);